import os
from dotenv import load_dotenv
import logging

# Настройка логирования
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# Явная загрузка .env с диагностикой
dotenv_path = os.path.join(os.path.dirname(__file__), '.env')
if os.path.exists(dotenv_path):
    load_dotenv(dotenv_path, verbose=True)
    logger.info("Файл .env загружен успешно")
else:
    logger.error(f"Файл .env не найден по пути: {dotenv_path}")

# Получение токена
API_TOKEN = os.getenv('BOT_API_TOKEN')

if not API_TOKEN:
    # Детальная диагностика
    logger.error("Токен не найден в переменных окружения!")
    logger.info("Доступные переменные окружения (частично):")
    for key in os.environ:
        if 'TOKEN' in key or 'BOT' in key:
            logger.info(f"{key}: {os.environ[key]}")
    raise ValueError(
        "Токен бота не найден! Проверьте:\n"
        "1. Наличие файла .env в директории бота\n"
        "2. Правильность имени переменной (BOT_API_TOKEN)\n"
        "3. Корректность токена в файле\n"
        "4. Права доступа к файлу .env"
    )

logger.info("Токен успешно загружен")
